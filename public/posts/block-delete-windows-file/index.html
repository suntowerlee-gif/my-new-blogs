<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Block Delete Windows File | Welcome to ZKPYKJ Tech Blog</title>
<meta name="keywords" content="">
<meta name="description" content="场景重新确认与整体思路评估
基于您描述的场景，我们的目标是确保普通用户（标准账户）在Windows 11专业版（Pro）或企业版（Enterprise）中，能够以自己的身份登录并运行软件，该软件需要对指定文件夹的完全控制权限（包括创建、修改和删除内部文件，以支持连续数据采集）。同时，在软件关闭后，该用户无法通过任何常见操作删除或移动软件生成的文件或文件夹本身。这包括阻止资源管理器（File Explorer）中的右键删除/重命名菜单、拖拽到回收站或移动动作、键盘Delete/Shift&#43;Delete/Cut（Ctrl&#43;X）等操作，以及禁用命令行工具（如CMD或PowerShell）来防止绕过。
您提出的思路——避免使用NTFS权限设置，转而通过禁用UI操作和命令行工具的“组合拳”——是一个可行的替代路径，尤其适用于不想修改文件系统权限的环境（如担心软件兼容性问题）。这个方法的核心是利用Windows的组策略（Group Policy）、注册表（Registry）修改和可选的第三方工具来限制用户交互，而不直接触及文件权限。这可以从多个层面“封堵”删除路径：UI层面（菜单和拖拽）、键盘输入层面，以及命令行层面。
优点与局限性（从多个角度分析）

优点：保持文件夹的默认NTFS权限（普通用户通常有修改权限），确保软件运行时无缝创建/编辑文件。设置相对简单、可逆，且在企业版中可通过域组策略集中部署。相比NTFS，它不会干扰软件的临时文件处理（如Office-style的保存机制）。
局限性：这些限制不是“铁板一块”。Windows设计上允许用户通过其他程序（如第三方文件管理器、脚本或甚至浏览器下载工具）绕过；例如，如果用户安装了Total Commander，它可能忽略某些组策略。禁用命令行会影响用户其他合法操作（如运行批处理脚本）。此外，系统更新（如Windows 11的累积更新）可能重置某些注册表设置，需要监控。
安全含义：这增加了用户挫败感（e.g., 无法重命名文件），但提升了数据保护。企业环境中，结合Windows Defender或Endpoint Manager可审计绕过尝试。
兼容性考虑：软件必须以普通用户权限运行；如果它依赖CMD/PowerShell（如某些安装脚本），需测试。边缘案例：如果文件夹在网络共享上，这些本地设置无效，需要服务器端配置。
法律/合规角度：在公司环境中，确保符合数据保留政策（如GDPR要求不可删数据）；但如果用户是儿童或受限群体，需注意访问性法规。
性能影响：最小，组策略和注册表修改不消耗资源。
可逆性：所有变更可轻松回滚（e.g., 禁用组策略或删除注册表键）。

此方法在Microsoft文档、社区论坛（如Reddit、SuperUser）和专家交流（如Experts Exchange）中被验证有效，尤其在 kiosk 或受限用户场景中。以下是详细步骤，按类别结构化，覆盖原生工具优先，辅以第三方备选。
步骤1: 使用组策略（GPO）禁用命令行工具和部分UI操作
组策略是Windows Pro/Enterprise的核心工具，可针对标准用户应用限制，而不影响管理员。企业版支持域级GPO，便于多机部署。
核心设置（针对CMD和PowerShell）


以管理员身份打开组策略编辑器：

按Win &#43; R，输入gpedit.msc，回车。
导航到用户配置 &gt; 管理模板 &gt; 系统。



禁用命令提示符（CMD）：

双击阻止访问命令提示符（Prevent access to the command prompt）。
选择已启用，并在选项中勾选禁用命令提示符脚本处理（Yes, disable command prompt script processing also）。这阻止批处理文件运行。
应用后，标准用户尝试打开CMD会提示“操作已被取消由于此计算机上的限制”。



禁用PowerShell（类似CMD的替代）：

导航到用户配置 &gt; 管理模板 &gt; Windows 组件 &gt; Windows PowerShell。
双击关闭WinRM客户端访问和关闭WinRM服务（如果适用），或直接禁用运行PowerShell脚本。
备选：使用AppLocker（企业版）限制PowerShell.exe执行：计算机配置 &gt; Windows 设置 &gt; 安全设置 &gt; 应用程序控制策略 &gt; AppLocker &gt; 可执行规则 → 创建规则拒绝标准用户运行%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe。



禁用运行对话框（Run）和任务管理器（防止间接命令行访问）：">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/block-delete-windows-file/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/block-delete-windows-file/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Welcome to ZKPYKJ Tech Blog (Alt + H)">Welcome to ZKPYKJ Tech Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Block Delete Windows File
    </h1>
    <div class="post-meta"><span title='2026-01-04 21:23:18 +0800 CST'>January 4, 2026</span>

</div>
  </header> 
  <div class="post-content"><h3 id="场景重新确认与整体思路评估">场景重新确认与整体思路评估<a hidden class="anchor" aria-hidden="true" href="#场景重新确认与整体思路评估">#</a></h3>
<p>基于您描述的场景，我们的目标是确保普通用户（标准账户）在Windows 11专业版（Pro）或企业版（Enterprise）中，能够以自己的身份登录并运行软件，该软件需要对指定文件夹的完全控制权限（包括创建、修改和删除内部文件，以支持连续数据采集）。同时，在软件关闭后，该用户无法通过任何常见操作删除或移动软件生成的文件或文件夹本身。这包括阻止资源管理器（File Explorer）中的右键删除/重命名菜单、拖拽到回收站或移动动作、键盘Delete/Shift+Delete/Cut（Ctrl+X）等操作，以及禁用命令行工具（如CMD或PowerShell）来防止绕过。</p>
<p>您提出的思路——避免使用NTFS权限设置，转而通过禁用UI操作和命令行工具的“组合拳”——是一个可行的替代路径，尤其适用于不想修改文件系统权限的环境（如担心软件兼容性问题）。这个方法的核心是利用Windows的组策略（Group Policy）、注册表（Registry）修改和可选的第三方工具来限制用户交互，而不直接触及文件权限。这可以从多个层面“封堵”删除路径：UI层面（菜单和拖拽）、键盘输入层面，以及命令行层面。</p>
<h4 id="优点与局限性从多个角度分析">优点与局限性（从多个角度分析）<a hidden class="anchor" aria-hidden="true" href="#优点与局限性从多个角度分析">#</a></h4>
<ul>
<li><strong>优点</strong>：保持文件夹的默认NTFS权限（普通用户通常有修改权限），确保软件运行时无缝创建/编辑文件。设置相对简单、可逆，且在企业版中可通过域组策略集中部署。相比NTFS，它不会干扰软件的临时文件处理（如Office-style的保存机制）。</li>
<li><strong>局限性</strong>：这些限制不是“铁板一块”。Windows设计上允许用户通过其他程序（如第三方文件管理器、脚本或甚至浏览器下载工具）绕过；例如，如果用户安装了Total Commander，它可能忽略某些组策略。禁用命令行会影响用户其他合法操作（如运行批处理脚本）。此外，系统更新（如Windows 11的累积更新）可能重置某些注册表设置，需要监控。</li>
<li><strong>安全含义</strong>：这增加了用户挫败感（e.g., 无法重命名文件），但提升了数据保护。企业环境中，结合Windows Defender或Endpoint Manager可审计绕过尝试。</li>
<li><strong>兼容性考虑</strong>：软件必须以普通用户权限运行；如果它依赖CMD/PowerShell（如某些安装脚本），需测试。边缘案例：如果文件夹在网络共享上，这些本地设置无效，需要服务器端配置。</li>
<li><strong>法律/合规角度</strong>：在公司环境中，确保符合数据保留政策（如GDPR要求不可删数据）；但如果用户是儿童或受限群体，需注意访问性法规。</li>
<li><strong>性能影响</strong>：最小，组策略和注册表修改不消耗资源。</li>
<li><strong>可逆性</strong>：所有变更可轻松回滚（e.g., 禁用组策略或删除注册表键）。</li>
</ul>
<p>此方法在Microsoft文档、社区论坛（如Reddit、SuperUser）和专家交流（如Experts Exchange）中被验证有效，尤其在 kiosk 或受限用户场景中。以下是详细步骤，按类别结构化，覆盖原生工具优先，辅以第三方备选。</p>
<h3 id="步骤1-使用组策略gpo禁用命令行工具和部分ui操作">步骤1: 使用组策略（GPO）禁用命令行工具和部分UI操作<a hidden class="anchor" aria-hidden="true" href="#步骤1-使用组策略gpo禁用命令行工具和部分ui操作">#</a></h3>
<p>组策略是Windows Pro/Enterprise的核心工具，可针对标准用户应用限制，而不影响管理员。企业版支持域级GPO，便于多机部署。</p>
<h4 id="核心设置针对cmd和powershell">核心设置（针对CMD和PowerShell）<a hidden class="anchor" aria-hidden="true" href="#核心设置针对cmd和powershell">#</a></h4>
<ol>
<li>
<p><strong>以管理员身份打开组策略编辑器</strong>：</p>
<ul>
<li>按Win + R，输入<code>gpedit.msc</code>，回车。</li>
<li>导航到<strong>用户配置 &gt; 管理模板 &gt; 系统</strong>。</li>
</ul>
</li>
<li>
<p><strong>禁用命令提示符（CMD）</strong>：</p>
<ul>
<li>双击<strong>阻止访问命令提示符</strong>（Prevent access to the command prompt）。</li>
<li>选择<strong>已启用</strong>，并在选项中勾选<strong>禁用命令提示符脚本处理</strong>（Yes, disable command prompt script processing also）。这阻止批处理文件运行。</li>
<li>应用后，标准用户尝试打开CMD会提示“操作已被取消由于此计算机上的限制”。</li>
</ul>
</li>
<li>
<p><strong>禁用PowerShell（类似CMD的替代）</strong>：</p>
<ul>
<li>导航到<strong>用户配置 &gt; 管理模板 &gt; Windows 组件 &gt; Windows PowerShell</strong>。</li>
<li>双击<strong>关闭WinRM客户端访问</strong>和<strong>关闭WinRM服务</strong>（如果适用），或直接禁用<strong>运行PowerShell脚本</strong>。</li>
<li>备选：使用AppLocker（企业版）限制PowerShell.exe执行：<strong>计算机配置 &gt; Windows 设置 &gt; 安全设置 &gt; 应用程序控制策略 &gt; AppLocker &gt; 可执行规则</strong> → 创建规则拒绝标准用户运行<code>%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe</code>。</li>
</ul>
</li>
<li>
<p><strong>禁用运行对话框（Run）和任务管理器（防止间接命令行访问）</strong>：</p>
<ul>
<li>在<strong>用户配置 &gt; 管理模板 &gt; 开始菜单和任务栏</strong>，启用<strong>删除“运行”菜单</strong>（Remove Run menu from Start Menu）。</li>
<li>在<strong>用户配置 &gt; 管理模板 &gt; 系统 &gt; Ctrl+Alt+Del选项</strong>，启用<strong>删除任务管理器</strong>（Remove Task Manager）。</li>
</ul>
</li>
<li>
<p><strong>应用并测试</strong>：</p>
<ul>
<li>运行<code>gpupdate /force</code>刷新策略。</li>
<li>切换到标准用户：尝试Win + R打开Run，或CMD，应失败。这防止用户用<code>del</code>命令删除文件。</li>
</ul>
</li>
</ol>
<h4 id="企业版扩展">企业版扩展<a hidden class="anchor" aria-hidden="true" href="#企业版扩展">#</a></h4>
<ul>
<li>通过域控制器创建GPO，链接到OU（组织单位），仅针对标准用户组（Users）。这确保管理员不受影响。</li>
</ul>
<h4 id="细微差别">细微差别<a hidden class="anchor" aria-hidden="true" href="#细微差别">#</a></h4>
<ul>
<li>如果软件依赖CMD/PowerShell（罕见，但如自动化脚本），需白名单特定命令（通过自定义GPO脚本）。</li>
<li>边缘：用户可通过WSL（Windows Subsystem for Linux）绕过，如果启用；禁用WSL via <strong>控制面板 &gt; 程序和功能 &gt; 启用或关闭Windows功能</strong>。</li>
</ul>
<h3 id="步骤2-通过注册表修改禁用资源管理器中的删除菜单重命名和键盘操作">步骤2: 通过注册表修改禁用资源管理器中的删除菜单、重命名和键盘操作<a hidden class="anchor" aria-hidden="true" href="#步骤2-通过注册表修改禁用资源管理器中的删除菜单重命名和键盘操作">#</a></h3>
<p>注册表修改可精确针对File Explorer的上下文菜单和键盘行为。备份注册表（Regedit &gt; 文件 &gt; 导出）以防万一。</p>
<ol>
<li>
<p><strong>禁用右键上下文菜单中的“删除”和“重命名”</strong>：</p>
<ul>
<li>打开Regedit（Win + R &gt; regedit）。</li>
<li>导航到<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>（如果无，创建）。</li>
<li>创建DWORD值：<code>NoDelete</code> = 1（禁用删除菜单）；<code>NoRename</code> = 1（禁用重命名）。</li>
<li>对于所有用户：用<code>HKEY_LOCAL_MACHINE</code>路径，并用GPO推送。</li>
<li>重启Explorer（任务管理器 &gt; 结束explorer.exe &gt; 文件 &gt; 新任务 &gt; explorer.exe）。</li>
<li>测试：右键文件，删除/重命名选项消失。</li>
</ul>
</li>
<li>
<p><strong>禁用键盘Delete键和Shift+Delete在File Explorer中</strong>：</p>
<ul>
<li>直接禁用特定键需第三方，但原生近似：导航到<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>。</li>
<li>创建DWORD：<code>NoWinKeys</code> = 1（禁用部分Windows热键，但不直接针对Delete）。</li>
<li>更精确：用PowerToys（Microsoft免费工具，下载自Microsoft Store）中的Keyboard Manager重映射Delete键为无操作（在File Explorer上下文中）。</li>
<li>备选注册表：创建<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System</code>，添加<code>DisableKey</code>字符串值，包含Delete的扫描码（但复杂，参考SharpKeys工具生成）。</li>
</ul>
</li>
<li>
<p><strong>禁用拖拽和掉落到回收站/移动</strong>：</p>
<ul>
<li>导航到<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>。</li>
<li>创建DWORD：<code>NoDrag</code> = 1（禁用拖拽）。</li>
<li>增加拖拽阈值（使拖拽不敏感）：在<code>HKEY_CURRENT_USER\Desktop</code>，设置<code>DragHeight</code>和<code>DragWidth</code>为4096（像素），用户需拖很远才触发。</li>
<li>对于回收站具体：导航到<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\NonEnum</code>，添加<code>{645FF040-5081-101B-9F08-00AA002F954E}</code> = 1（隐藏回收站，但不完全禁用拖拽）。</li>
<li>测试：尝试拖文件到回收站或另一文件夹，应无响应或需极远距离。</li>
</ul>
</li>
</ol>
<h4 id="示例注册表文件reg批量应用">示例注册表文件（.reg）批量应用<a hidden class="anchor" aria-hidden="true" href="#示例注册表文件reg批量应用">#</a></h4>
<ul>
<li>创建文本文件，粘贴：
<pre tabindex="0"><code>Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]
&#34;NoDelete&#34;=dword:00000001
&#34;NoRename&#34;=dword:00000001
&#34;NoDrag&#34;=dword:00000001
[HKEY_CURRENT_USER\Desktop]
&#34;DragHeight&#34;=&#34;4096&#34;
&#34;DragWidth&#34;=&#34;4096&#34;
</code></pre></li>
<li>保存为.reg，双击导入。适用于当前用户；用管理员运行影响所有。</li>
</ul>
<h4 id="细微差别与边缘">细微差别与边缘<a hidden class="anchor" aria-hidden="true" href="#细微差别与边缘">#</a></h4>
<ul>
<li>这些不影响软件内部删除（e.g., 软件用API删除临时文件）。</li>
<li>边缘：用户可通过“剪切”（Ctrl+X）+“粘贴”绕过；禁用Ctrl键组合 via 注册表<code>Scancode Map</code>（复杂，需重启）。</li>
<li>如果Windows更新重置：用任务调度器脚本定期应用.reg。</li>
</ul>
<h3 id="步骤3-禁用其他潜在绕过路径键盘剪切移动等">步骤3: 禁用其他潜在绕过路径（键盘剪切、移动等）<a hidden class="anchor" aria-hidden="true" href="#步骤3-禁用其他潜在绕过路径键盘剪切移动等">#</a></h3>
<ol>
<li>
<p><strong>禁用键盘剪切（Ctrl+X）和移动</strong>：</p>
<ul>
<li>用PowerToys Keyboard Manager：重映射Ctrl+X为无（全局或Explorer-specific）。</li>
<li>原生：注册表<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>，添加<code>NoCut</code> = 1（但非标准，测试中有效率低）。</li>
</ul>
</li>
<li>
<p><strong>阻止通过其他工具删除</strong>：</p>
<ul>
<li>启用AppLocker（企业版）：拒绝标准用户运行常见文件管理器如cmd.exe、powershell.exe、del命令。</li>
<li>禁用回收站确认：但反之，启用删除确认（Regedit: <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>，<code>ConfirmFileDelete</code> = 1），增加障碍。</li>
</ul>
</li>
</ol>
<h3 id="步骤4-可选第三方工具增强如果原生不足">步骤4: 可选第三方工具增强（如果原生不足）<a hidden class="anchor" aria-hidden="true" href="#步骤4-可选第三方工具增强如果原生不足">#</a></h3>
<ul>
<li><strong>AutoHotkey</strong>：脚本禁用特定键/动作 in Explorer（e.g., #IfWinActive ahk_class CabinetWClass, Del::return）。</li>
<li><strong>Directory Defender</strong>（Blue Shoe Software）：专门防止文件删除，而不改权限。</li>
<li><strong>SharpKeys</strong>：重映射Delete键。</li>
<li>含义：第三方增加灵活性，但引入依赖；企业中评估安全。</li>
</ul>
<h3 id="综合测试与维护">综合测试与维护<a hidden class="anchor" aria-hidden="true" href="#综合测试与维护">#</a></h3>
<ol>
<li><strong>验证流程</strong>：创建测试文件夹，运行软件生成文件；关闭后，尝试所有禁止操作，应失败。</li>
<li><strong>监控</strong>：启用文件审核（文件夹属性 &gt; 安全 &gt; 高级 &gt; 审核），日志事件查看器中失败删除。</li>
<li><strong>回滚</strong>：删除注册表键，禁用GPO，运行<code>gpupdate</code>。</li>
<li><strong>相关考虑</strong>：如果软件生成的文件需额外保护，结合BitLocker加密文件夹。未来Windows版本（如24H2）可能引入新限制，定期检查更新。</li>
</ol>
<p>这个组合拳在实际案例中（如学校/公司受限账户）证明有效，但若用户高度技术化，可能需NTFS作为后备。提供更多软件细节可进一步优化。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Welcome to ZKPYKJ Tech Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
